<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" class="no-js no-svg js" lang="fr-FR"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/124f0ac6629b55d655000be72939959c.css" data-minify="1"><link rel="stylesheet" href="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/76369453efc8f4c4e9b42f608005e2ad.css" data-minify="1"><link rel="stylesheet" href="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/339d90e2eea4ff7c4064bfff31a62335.css" data-minify="1"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="profile" href="http://gmpg.org/xfn/11"><title>R√©cup√©rer les coordonn√©es GPS de vos visiteurs ‚Äì Wabeo</title><meta name="description" content="Faisons le tour de quelques m√©thodes permettant de r√©cup√©rer la position g√©ographique de vos visiteurs dans le but de leur servir un contenu sur-mesure."><link rel="canonical" href="https://wabeo.fr/coordonnees-gps-utilisateur/"><meta property="og:locale" content="fr_FR"><meta property="og:type" content="article"><meta property="og:title" content="R√©cup√©rer les coordonn√©es GPS de vos visiteurs ‚Äì Wabeo"><meta property="og:description" content="Faisons le tour de quelques m√©thodes permettant de r√©cup√©rer la position g√©ographique de vos visiteurs dans le but de leur servir un contenu sur-mesure."><meta property="og:url" content="https://wabeo.fr/coordonnees-gps-utilisateur/"><meta property="og:site_name" content="Wabeo"><meta property="article:publisher" content="https://www.facebook.com/wabeoCreation/"><meta property="article:tag" content="WordPress &amp; G√©olocalisation"><meta property="article:tag" content="Am√©liorer l'exp√©rience utilisateur"><meta property="article:section" content="D√©veloppement WordPress"><meta property="article:published_time" content="2015-04-08T07:02:04+01:00"><meta property="article:modified_time" content="2017-03-06T14:58:18+01:00"><meta property="og:updated_time" content="2017-03-06T14:58:18+01:00"><meta property="og:image" content="https://wabeo.fr/wp-content/uploads/2015/04/geolocalisation-par-ip.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="Faisons le tour de quelques m√©thodes permettant de r√©cup√©rer la position g√©ographique de vos visiteurs dans le but de leur servir un contenu sur-mesure."><meta name="twitter:title" content="R√©cup√©rer les coordonn√©es GPS de vos visiteurs ‚Äì Wabeo"><meta name="twitter:site" content="@willybahuaud"><meta name="twitter:image" content="https://wabeo.fr/wp-content/uploads/2015/04/geolocalisation-par-ip.jpg"><meta name="twitter:creator" content="@willybahuaud"><link rel="dns-prefetch" href="https://s.w.org/"><link rel="alternate" type="application/rss+xml" title="Wabeo ¬ª R√©cup√©rer les coordonn√©es GPS d‚Äôun visiteur Flux des commentaires" href="https://wabeo.fr/coordonnees-gps-utilisateur/feed/"> <script type="text/javascript" async="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/recaptcha__en.js"></script><script type="text/javascript" async="" defer="defer" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/piwik.js"></script><script type="text/javascript">window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/wabeo.fr\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);</script><script src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-emoji-release.js" type="text/javascript" defer="defer"></script> <style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style> <script type="text/javascript" data-cfasync="false" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-includes-js-jquery-jquery-1.js"></script> <script type="text/javascript" data-cfasync="false" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-includes-js-jquery-jquery-migrate.js"></script> <link rel="https://api.w.org/" href="https://wabeo.fr/wp-json/"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://wabeo.fr/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://wabeo.fr/wp-includes/wlwmanifest.xml"><meta name="generator" content="WordPress 4.9"><link rel="shortlink" href="https://wabeo.fr/?p=2653"><link rel="alternate" type="application/json+oembed" href="https://wabeo.fr/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwabeo.fr%2Fcoordonnees-gps-utilisateur%2F"><link rel="alternate" type="text/xml+oembed" href="https://wabeo.fr/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwabeo.fr%2Fcoordonnees-gps-utilisateur%2F&amp;format=xml"> <script type="text/javascript">document.documentElement.className += " js";</script> <link rel="dns-prefetch" href="https://s.w.org/"> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-embed.js"></script> <link rel="icon" href="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-32x32.jpg" sizes="32x32"><link rel="icon" href="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-192x192.jpg" sizes="192x192"><link rel="apple-touch-icon-precomposed" href="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-180x180.jpg"><meta name="msapplication-TileImage" content="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-270x270.jpg"><link rel="icon" href="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-32x32.jpg" sizes="32x32"><link rel="icon" href="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-192x192.jpg" sizes="192x192"><link rel="apple-touch-icon-precomposed" href="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-180x180.jpg"><meta name="msapplication-TileImage" content="https://wabeo.fr/wp-content/uploads/2017/01/cropped-logo-wabeo-270x270.jpg"></head><body class="post-template-default single single-post postid-2653 single-format-standard ajax fixed tocfixed"><div id="canvas-wrapper" class="canvas-wrapper"><canvas id="myCanvas" class="scene left" width="2732" height="1092" resize="" style="-moz-user-select: none;" data-paper-scope="1"></canvas></div> <header id="header"> <a href="https://wabeo.fr/" class="logo">Wabeo <span>D√©veloppeur <br>WordPress</span> <canvas id="logo-img" class="logo-img" width="100" height="100" style="-moz-user-select: none;"></canvas></a> <nav id="menu-menu-haut-container" class="menu-menu-haut-container"><ul id="menu-menu-haut" class="nav"><li id="menu-item-3456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-3456"><a href="https://wabeo.fr/">Services</a></li><li id="menu-item-3499" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent current-menu-item menu-item-3499"><a href="https://wabeo.fr/blog/">Blog</a></li><li id="menu-item-3497" class="menu-item menu-item-type-post_type_archive menu-item-object-portfolio menu-item-3497"><a href="https://wabeo.fr/references/">R√©alisations</a></li><li id="menu-item-3454" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3454"><a href="https://wabeo.fr/contact/">Contact</a></li></ul><button id="switch-menu" class="switch-menu" type="button">Menu</button></nav> </header><div class="main-wrapper" id="main-wrapper"> <main class="main-center will-out modele-article"><div class="article-content-wrapper texte"><h1>R√©cup√©rer les coordonn√©es GPS d‚Äôun visiteur</h1><p>J‚Äôai
 travaill√© sur certains projets o√π le contenu devait √™tre servi aux 
internautes en fonction de leurs positions g√©ographiques. Un pr√©-requis √†
 la mise en place d‚Äôun tel syst√®me est justement de conna√Ætre les 
coordonn√©es GPS des visiteurs d‚Äôun site web.</p><p>Dans cet article je vais vous pr√©senter quelques m√©thodes pour recueillir ces informations.<span id="more-2653"></span></p> <figure id="attachment_2740" style="max-width: 800px" class="wp-caption aligncenter"><a href="https://wabeo.fr/wp-content/uploads/2015/04/geolocalisation-par-ip.jpg" rel="attachment wp-att-2740"><img class="size-full wp-image-2740" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/geolocalisation-par-ip.jpg" alt="geolocalisation par IP" srcset="https://wabeo.fr/wp-content/uploads/2015/04/geolocalisation-par-ip.jpg 800w, https://wabeo.fr/wp-content/uploads/2015/04/geolocalisation-par-ip-300x150.jpg 300w, https://wabeo.fr/wp-content/uploads/2015/04/geolocalisation-par-ip-768x384.jpg 768w" sizes="(max-width: 800px) 100vw, 800px" width="800" height="400"></a><figcaption class="wp-caption-text">G√©olocaliser un utilisateur par son IP, ou par l‚ÄôAPI geolocate</figcaption></figure><h2 id="geolocaliser-un-visiteur-par-son-ip">Geolocaliser un visiteur par son IP</h2><p>Je
 vous propose de d√©buter le tour d‚Äôhorizon des diff√©rentes techniques de
 r√©cup√©ration des coordonn√©es GPS par celle qui est la plus archa√Øque, 
mais la seule qui ne n√©cessite pas le consentement de l‚Äôinternaute. 
Cette m√©thode n‚Äôest pas la plus pr√©cise, et pr√©sente deux 
inconv√©nients&nbsp;:</p><ul><li>Il faut se procurer et installer une base de donn√©es des plages d‚ÄôIP par ville (¬±190 mo) ;</li><li>Elle ne ressort pas des r√©sultats tr√®s pr√©cis (de l‚Äôordre de la ville) et est incapable de g√©olocaliser un ¬´mobinaute¬ª.</li></ul><p>Je
 vous invite tout de m√™me √† l‚Äôexp√©rimenter, tout d‚Äôabord parce que c‚Äôest
 int√©ressant de comprendre comment cela marche, mais aussi car cette 
m√©thode nous servira d‚Äôalternative lorsque les autres ne fonctionneront 
pas.</p><h3 id="mise-en-place-de-la-table">Mise en place de la table</h3><p>Pour
 commencer, il faut se procurer une base de Geo IP. Certains services de
 geolocalisation mettent √† disposition gratuitement, pour un usage 
non-commercial, des versions all√©g√©es de leurs propres bases de donn√©es.
 Ces bases, bien que d√©j√† relativement compl√®tes, contiennent moins 
d‚Äôinformations, et sont plus rarement mises √† jour que leurs bases 
payantes ou sur abonnement.</p><p>J‚Äôai test√© une base ¬´lite¬ª fournie par le service <a title="Des bases de geolocalisation par plage d'IP gratuites pour un usage personnel" href="http://lite.ip2location.com/databases" target="_blank">ip2location</a>.
 Vous pouvez vous la procurer ici en vous inscrivant gratuitement. Vous 
recevrez par email la liste des bases de donn√©es disponibles. Celle 
qu‚Äôil vous faut est la <em>ip2location_db5</em> au format CSV. Elle contient les pages d‚ÄôIP relatives √† de nombreuses villes, ainsi que les coordonn√©es GPS correspondantes.</p><p>Pour
 l‚Äôutiliser, il faut ins√©rer les informations qu‚Äôelle contient dans une 
nouvelle table de votre installation de WordPress. Il faut donc cr√©er 
cette nouvelle table.</p><p>Tout d‚Äôabord, <strong>sauvegardez votre base de donn√©es</strong>.</p><p>Puis,
 connectez-vous √† votre interface MySQL (via PHPMyAdmin, adminer, ou en 
SSH pour les puristes‚Ä¶), positionnez-vous dans la base de donn√©es de 
votre installation de WordPress, puis ex√©cuter la requ√™te 
suivante&nbsp;:</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-sql" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>wp_ip2location_db5<span class="token punctuation">`</span><span class="token punctuation">(</span> <span class="token punctuation">`</span>ip_from<span class="token punctuation">`</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> UNSIGNED<span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>ip_to<span class="token punctuation">`</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> UNSIGNED<span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>country_code<span class="token punctuation">`</span> CHAR<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>country_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>region_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>city_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>latitude<span class="token punctuation">`</span> <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span> 
                               <span class="token punctuation">`</span>longitude<span class="token punctuation">`</span> <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span> 

                               <span class="token keyword">INDEX</span> <span class="token punctuation">`</span>idx_ip_from<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>ip_from<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                               <span class="token keyword">INDEX</span> <span class="token punctuation">`</span>idx_ip_to<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>ip_to<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                               <span class="token keyword">INDEX</span> <span class="token punctuation">`</span>idx_ip_from_to<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>ip_from<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>ip_to<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> 
<span class="token keyword">ENGINE</span><span class="token operator">=</span>MyISAM <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin<span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/create-table-ip2location.sql" title="Afficher create-table-ip2location.sql" target="_blank" class="code-embed-name">create-table-ip2location.sql</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/create-table-ip2location.sql" title="Back to create-table-ip2location.sql" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>La
 table est maintenant cr√©√©e, ne reste plus qu‚Äô√† y ins√©rer les donn√©es. 
Pour cela uploadez le fichier CSV sur votre serveur ‚Äì par FTP ou autre ‚Äì
 puis ex√©cutez cette nouvelle requ√™te&nbsp;:</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-sql" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-sql"><span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">LOCAL</span> <span class="token keyword">INFILE</span> <span class="token string">'/home/www/public_html/sql/IP2LOCATION-LITE-DB5.CSV'</span> 
<span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> wp_ip2location_db5 
<span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED BY</span> <span class="token string">','</span> <span class="token keyword">ENCLOSED BY</span> <span class="token string">'"'</span> 
<span class="token keyword">LINES</span> <span class="token keyword">TERMINATED BY</span> <span class="token string">'\r\n'</span> 
<span class="token keyword">IGNORE</span> <span class="token number">0</span> <span class="token keyword">LINES</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/insert-data.sql" title="Afficher insert-data.sql" target="_blank" class="code-embed-name">insert-data.sql</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/insert-data.sql" title="Back to insert-data.sql" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Bien s√ªr, il faut adapter le chemin du fichier pour cibler l‚Äôemplacement du CSV sur votre serveur&nbsp;<img draggable="false" class="emoji" alt="üòõ" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1f61b.svg"></p><p>Si
 tout s‚Äôest bien d√©roul√©, vous ne devriez pas avoir de message d‚Äôerreur,
 et voir maintenant ¬± 1917071 lignes ins√©r√©es dans votre nouvelle table.</p><h3 id="recuperer-les-coordonnees-gps-a-partir-de-lip">R√©cup√©rer les coordonn√©es GPS √† partir de l‚ÄôIP</h3><p>La
 table que l‚Äôon vient de mettre en place va nous servir √† trouver les 
coordonn√©es g√©ographiques approximatives d‚Äôun internaute en fonction de 
son IP, encore faut-il la connaitre‚Ä¶</p><p>La variable <em>$_SERVER</em>
 contient de nombreuses informations, dont l‚Äôadresse IP de connexion. 
Celle-ci est g√©n√©ralement accessible sous la clef ¬´REMOTE_ADDR¬ª, mais 
dans certains cas ‚Äì par exemple si votre site est servi derri√®re un 
proxy ‚Äì l‚ÄôIP retourn√©e via REMOTE_ADDR ne sera pas correcte. D‚Äôautres 
entr√©es de la variable <em>$_SERVER</em> peuvent vous donner une IP plus pertinente.</p><p>Voici une fonction pour r√©cup√©rer la v√©ritable IP de votre visiteur, en testant chaque information disponible.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-php" data-start="3" data-line-offset="2" style="counter-reset: linenumber 2;"><code class=" code-embed-code language-php"><span class="token keyword">function</span> <span class="token function">get_user_ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">// On test les variables serveur‚Ä¶</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
             <span class="token string">'HTTP_CLIENT_IP'</span><span class="token punctuation">,</span> 
             <span class="token string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">,</span> 
             <span class="token string">'HTTP_X_FORWARDED'</span><span class="token punctuation">,</span> 
             <span class="token string">'HTTP_X_CLUSTER_CLIENT_IP'</span><span class="token punctuation">,</span> 
             <span class="token string">'HTTP_FORWARDED_FOR'</span><span class="token punctuation">,</span> 
             <span class="token string">'HTTP_FORWARDED'</span><span class="token punctuation">,</span> 
             <span class="token string">'REMOTE_ADDR'</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token comment" spellcheck="true">// ‚Ä¶ si elles existes‚Ä¶</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">array_key_exists</span><span class="token punctuation">(</span> <span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token global">$_SERVER</span> <span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token comment" spellcheck="true">// ‚Ä¶ et pour chacune de leurs valeurs‚Ä¶</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token global">$_SERVER</span><span class="token punctuation">[</span> <span class="token variable">$key</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// ‚Ä¶ si c'est une adresse IP, mais pas une interne (ex : 192.0.0.1)‚Ä¶</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">filter_var</span><span class="token punctuation">(</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token constant">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token constant">FILTER_FLAG_NO_RES_RANGE</span> <span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span> 
                  <span class="token comment" spellcheck="true">// ‚Ä¶ ou une adresse de loopback (ex : 127.0.0.1)‚Ä¶</span>
                  <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token function">ip2long</span><span class="token punctuation">(</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff000000</span> <span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x7f000000</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  	<span class="token comment" spellcheck="true">// ‚Ä¶ on la retourne </span>
                    <span class="token keyword">return</span> <span class="token variable">$ip</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// Si aucune valeur n'est correte on renvoie false</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/get-user-ip.php" title="Afficher get-user-ip.php" target="_blank" class="code-embed-name">get-user-ip.php</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/get-user-ip.php" title="Back to get-user-ip.php" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Afin
 d‚Äôinterroger la table pour trouver les coordonn√©es de notre 
utilisateur, il faut convertir l‚ÄôIP ‚Äì que l‚Äôon a obtenu au format 
num√©rique ‚Äì au format litt√©ral. Il existe une fonction PHP toute 
faite&nbsp;:</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-php" data-line="3" data-start="2" data-line-offset="1" style="counter-reset: linenumber 1;"><code class=" code-embed-code language-php"><span class="token comment" spellcheck="true">// Mon ip</span>
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token string">'78.202.225.85'</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token function">ip2long</span><span class="token punctuation">(</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment" spellcheck="true">// ip2long() retourne l'adresse au format litt√©ral</span>

<span class="token comment" spellcheck="true">// ‚Ä¶ cela revient ¬± √† faire :</span>
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token variable">$ip1</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">)</span> 
		<span class="token operator">+</span> <span class="token variable">$ip1</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> 
		<span class="token operator">+</span> <span class="token variable">$ip1</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">256</span> 
		<span class="token operator">+</span> <span class="token variable">$ip1</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><div class=" line-highlight" data-start="3" style="top: 24px;"> 
</div><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/transform-user-ip.php" title="Afficher transform-user-ip.php" target="_blank" class="code-embed-name">transform-user-ip.php</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/transform-user-ip.php" title="Back to transform-user-ip.php" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Maintenant
 que nous disposons de toutes les informations n√©cessaires, il ne nous 
reste plus qu‚Äô√† faire une requ√™te en base de donn√©es pour obtenir les 
coordonn√©es de l‚Äôutilisateur.</p><p>Construisons une fonction pour cela&nbsp;:</p><ol><li>En premier lieu elle r√©cup√®re l‚ÄôIP num√©rique de l‚Äôinternaute ;</li><li>ensuite elle convertie son adresse au format litt√©ral ;</li><li>et enfin, en passant par l‚ÄôAPI sql de WordPress, on r√©cup√®re la ligne de la table correspondant √† la plage d‚ÄôIP.</li></ol><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-php" data-start="2" data-line-offset="1" style="counter-reset: linenumber 1;"><code class=" code-embed-code language-php"><span class="token keyword">function</span> <span class="token function">get_user_coords</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">// L'IP de notre utilisateur</span>
	<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">get_user_ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
		
	<span class="token comment" spellcheck="true">// ‚Ä¶ au format litt√©ral</span>
	<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">ip2long</span><span class="token punctuation">(</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token variable">$ip</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>
	<span class="token variable">$infos</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get_row</span><span class="token punctuation">(</span> 
    			<span class="token variable">$wpdb</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span> 
    				<span class="token string">"SELECT * FROM {$wpdb-&gt;prefix}ip2location_db5 WHERE %d BETWEEN ip_from AND ip_to"</span><span class="token punctuation">,</span> 
    				<span class="token variable">$ip</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$infos</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
		<span class="token string">'lat'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$infos</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">latitude</span><span class="token punctuation">;</span>
		<span class="token string">'lng'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$infos</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">longitude</span><span class="token punctuation">;</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">// Nous obtenons aussi :</span>
		<span class="token comment" spellcheck="true">// La ville : $infos-&gt;city_name;</span>
		<span class="token comment" spellcheck="true">// La r√©gion : $infos-&gt;region_name;</span>
		<span class="token comment" spellcheck="true">// Le pays : $infos-&gt;country_name;</span>
		<span class="token comment" spellcheck="true">// Le code Pays : $infos-&gt;country_code;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/get-coords-with-ip.php" title="Afficher get-coords-with-ip.php" target="_blank" class="code-embed-name">get-coords-with-ip.php</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/get-coords-with-ip.php" title="Back to get-coords-with-ip.php" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Nous
 avons donc obtenu les informations recherch√©es. Mais comme je 
l‚Äô√©voquais en introduction, il est possible que les coordonn√©es 
retourn√©es ne correspondent pas r√©ellement √† la localisation du 
visiteur, notamment s‚Äôil se connecte √† partir d‚Äôun t√©l√©phone cellulaire.
 Si tel est le cas vous n‚Äôobtiendrez que les coordonn√©es de la ville o√π 
se situe le central de l‚Äôop√©rateur.</p><p>Cette m√©thode est donc √† utiliser seulement dans le cas o√π celle dont je vais parler maintenant n‚Äôest pas disponible.</p><h2 id="en-javascript-via-le-navigateur">En javascript via le navigateur</h2><p>Cette
 fa√ßon de faire est beaucoup plus simple. Elle est √©galement 
relativement plus pr√©cise, puisque nous pourrons r√©cup√©rer des 
coordonn√©es relatives √† l‚Äôadresse exacte ‚Äì et non plus de l‚Äôordre de la 
ville.</p><p>Cependant, cette technique n√©cessite d‚Äôavoir le 
consentement de l‚Äôinternaute pour recueillir son positionnement. Le 
navigateur demandera au visiteur de cliquer sur un bouton, et il nous 
faudra donc attendre avant de lui servir un contenu souhait√©.</p><p>Nous ne pourrons donc pas pr√©charger de contenu personnalis√© pour l‚Äôinternaute.</p><p>Prenons
 l‚Äôexemple d‚Äôun annuaire&nbsp;: si vous souhaitez afficher les 
prestataires proche du domicile de votre utilisateur, il faudra 
recueillir son consentement en javascript, puis charger les fiches en 
ajax.</p><p>L‚Äôautre petit d√©faut de cette m√©thode est qu‚Äôelle n‚Äôest accessible qu‚Äô√†&nbsp;<a title="Voir le support de l'API heolocation html5" href="http://caniuse.com/#feat=geolocation" target="_blank">97% des internautes fran√ßais (IE9+)</a>.</p><p>Depuis HTML5, l‚Äôobjet <em>navigator</em> comprend une API <em>geolocation</em>. C‚Äôest √† elle que nous allons faire appel. Pour cela, on v√©rifie sa pr√©sence puis on utilise la m√©thode <em>getCurrentPosition</em> pour envoyer les coordonn√©es de l‚Äôinternaute √† une fonction javascript.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-javascript" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-javascript"><span class="token comment" spellcheck="true">// On v√©rifie que la m√©thode est impl√©ment√© dans le navigateur</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> navigator<span class="token punctuation">.</span>geolocation <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">// On demande d'envoyer la position courante √† la fonction callback</span>
	navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span> callback<span class="token punctuation">,</span> erreur <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">// Function alternative sinon</span>
	<span class="token function">alternative</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/html5-geolocation.js" title="Afficher html5-geolocation.js" target="_blank" class="code-embed-name">html5-geolocation.js</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/html5-geolocation.js" title="Back to html5-geolocation.js" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Si l‚ÄôAPI n‚Äôest pas support√©e par le navigateur, on utilisera une fonction alternative, passant par la table SQL.</p><p>En
 cas d‚Äôerreur, tel que le refus de l‚Äôinternaute d‚Äôacc√©der √† sa position,
 on passera aussi par la fonction alternative (mais nous pouvons en 
savoir davantage sur le soucis rencontr√©).</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-javascript" data-start="10" data-line-offset="9" style="counter-reset: linenumber 9;"><code class=" code-embed-code language-javascript"><span class="token keyword">function</span> <span class="token function">erreur</span><span class="token punctuation">(</span> error <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span> error<span class="token punctuation">.</span>code <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> error<span class="token punctuation">.</span>PERMISSION_DENIED<span class="token punctuation">:</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'L\'utilisateur a refus√© la demande'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>     
		<span class="token keyword">case</span> error<span class="token punctuation">.</span>POSITION_UNAVAILABLE<span class="token punctuation">:</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'Position ind√©termin√©e'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> error<span class="token punctuation">.</span>TIMEOUT<span class="token punctuation">:</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'R√©ponse trop lente'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment" spellcheck="true">// Function alternative</span>
	<span class="token function">alternative</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/html5-geolocation.js" title="Afficher html5-geolocation.js" target="_blank" class="code-embed-name">html5-geolocation.js</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/html5-geolocation.js" title="Back to html5-geolocation.js" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Si
 tout va bien, la fonction de callback re√ßoit un objet avec quelques 
informations dont la latitude et la longitude du visiteur, mais 
√©galement son altitude ou son sens de d√©placement si celui-ci est en 
mouvement. Bref, cette API n‚Äôest pas vraiment compliqu√©e&nbsp;<img draggable="false" class="emoji" alt="üôÇ" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1f642.svg"></p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-javascript" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-javascript"><span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span> position <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> lat <span class="token operator">=</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>latitude<span class="token punctuation">;</span>
    <span class="token keyword">var</span> lng <span class="token operator">=</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>longitude<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> lat<span class="token punctuation">,</span> lng <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// Do stuff</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/html5-get_user_position.js" title="Afficher html5-get_user_position.js" target="_blank" class="code-embed-name">html5-get_user_position.js</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/html5-get_user_position.js" title="Back to html5-get_user_position.js" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Notre alternative utilise ce que nous avons fait au premier chapitre. On construit une fonction qui sera appel√©e en ajax, via <em>admin-ajax.php</em>, et qui renverra les coordonn√©es de la ville de l‚Äôinternaute au format json √† notre script.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-php" data-start="2" data-line-offset="1" style="counter-reset: linenumber 1;"><code class=" code-embed-code language-php"><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string">'wp_ajax_get_user_coords'</span><span class="token punctuation">,</span> <span class="token string">'get_user_coords_json'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string">'wp_ajax_nopriv_get_user_coords'</span><span class="token punctuation">,</span> <span class="token string">'get_user_coords_json'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">get_user_coords_json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token variable">$coords</span> <span class="token operator">=</span> <span class="token function">get_user_coords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$coords</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">wp_send_json_success</span><span class="token punctuation">(</span> <span class="token variable">$coords</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token function">wp_send_json_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/admin-ajax-alternative.php" title="Afficher admin-ajax-alternative.php" target="_blank" class="code-embed-name">admin-ajax-alternative.php</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/admin-ajax-alternative.php" title="Back to admin-ajax-alternative.php" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Notez que, comme dans tout appel √† <em>admin-ajax</em>,
 il est n√©cessaire de pousser dans une variable javascript l‚ÄôURL de la 
page PHP qui re√ßoit la requ√™te. Pour cela il faudra utiliser la fonction
 <em>wp_localize_script</em>.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-javascript" data-start="8" data-line-offset="7" style="counter-reset: linenumber 7;"><code class=" code-embed-code language-javascript"><span class="token keyword">function</span> <span class="token function">alternative</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// pensez √† d√©finir le chemin vers admin-ajax.php‚Ä¶</span>
		<span class="token comment" spellcheck="true">// ‚Ä¶ en front via localize_script()‚Ä¶</span>
		<span class="token comment" spellcheck="true">// ‚Ä¶ au moment de l'enqueue de votre script</span>
		url<span class="token punctuation">:</span>adminajax<span class="token punctuation">,</span>
		data<span class="token punctuation">:</span><span class="token punctuation">{</span>
			action<span class="token punctuation">:</span>get_user_coords
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> data <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> data<span class="token punctuation">.</span>success <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> lat <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>lat<span class="token punctuation">;</span>
			<span class="token keyword">var</span> lat <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>lng<span class="token punctuation">;</span>
    		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> lat<span class="token punctuation">,</span> lng <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment" spellcheck="true">// Do stuff</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/html5-get_user_position.js" title="Afficher html5-get_user_position.js" target="_blank" class="code-embed-name">html5-get_user_position.js</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/html5-get_user_position.js" title="Back to html5-get_user_position.js" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Vous disposez maintenant d‚Äôune technique compl√®te pour r√©colter les coordonn√©es GPS de vos visiteurs&nbsp;<img draggable="false" class="emoji" alt="üòÄ" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1f600.svg"></p><h2 id="formulaire-et-api-de-geocoding">Formulaire et API de geocoding</h2><p>Il
 reste tout de m√™me une ultime approche √† aborder&nbsp;: parfois nous ne
 souhaitons pas r√©ellement les coordonn√©es de l‚Äôinternaute, mais plut√¥t 
la position du lieu qui l‚Äôint√©resse. C‚Äôest le cas sur un site 
d‚Äôimmobilier, lorsque le visiteur s√©lectionne une zone g√©ographique dans
 laquelle il aimerait s‚Äôinstaller.</p><p>Bien s√ªr, pour parvenir √† nos 
fins on pourrait opter pour un tri par taxonomies ‚Äì et les tax_query qui
 vont avec ‚Äì mais si la liste des villes propos√©es par l‚Äôagent 
immobilier est tr√®s compl√®te, et le nombre de biens cons√©quents, nous 
n‚Äôallons tout de m√™me pas demander √† l‚Äôutilisateur de saisir la liste 
exhaustive des zones qui l‚Äôint√©resse. Il pourrait en omettre et passer √†
 c√¥t√© de son r√™ve <img draggable="false" class="emoji" alt="üòâ" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1f609.svg"></p><p>Le
 plus simple est de lui demander une ville, qui sera le point central, 
et trouver les coordonn√©es associ√©es √† cet endroit. Nous pourrons alors 
faire des <a href="https://wabeo.fr/requete-geolocalisee-wordpress/#trier-les-resultats-en-fonction-de-la-proximite">requ√™tes g√©olocalis√©es pour trouver les r√©sultats correspondants</a>.</p><p>Nous avons besoin d‚Äôun formulaire dans lequel l‚Äôutilisateur pourra saisir sa recherche.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-markup" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>adresse<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Recherche par adresse : <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span> 
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>adresse<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>adresse<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Rechercher<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/formulaire-recherche.html" title="Afficher formulaire-recherche.html" target="_blank" class="code-embed-name">formulaire-recherche.html</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/formulaire-recherche.html" title="Back to formulaire-recherche.html" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>√Ä
 la soumission de ce formulaire nous allons r√©cup√©rer l‚Äôadresse voulue, 
envoyer une requ√™te √† l‚ÄôAPI de geocoding de Google, et retenir la 
position GPS du premier r√©sultat trouv√©.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-php" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-php"><span class="token delimiter">&lt;?php</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string">'init'</span><span class="token punctuation">,</span> <span class="token string">'get_coords_from_form'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">get_coords_from_form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token function">is_admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	  <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string">'adresse'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  	<span class="token comment" spellcheck="true">// On construit une URL pour envoyer une requ√™te √† l'API Google</span>
	  	<span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string">'https://maps.googleapis.com/maps/api/geocode/json'</span><span class="token punctuation">;</span>
	  	<span class="token variable">$adresse</span> <span class="token operator">=</span> <span class="token function">sanitize_text_field</span><span class="token punctuation">(</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string">'adresse'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	  	<span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">add_query_arg</span><span class="token punctuation">(</span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token string">'address'</span><span class="token punctuation">,</span> <span class="token variable">$adresse</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$url</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

	  	<span class="token variable">$requete</span> <span class="token operator">=</span> <span class="token function">wp_remote_get</span><span class="token punctuation">(</span> <span class="token variable">$url</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	  	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">200</span> <span class="token operator">==</span> <span class="token function">wp_remote_retrieve_response_code</span><span class="token punctuation">(</span> <span class="token variable">$requete</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  		<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span> <span class="token function">wp_remote_retrieve_body</span><span class="token punctuation">(</span> <span class="token variable">$requete</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	  		<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">isset</span><span class="token punctuation">(</span> <span class="token variable">$results</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">geometry</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">location</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">lat</span><span class="token punctuation">,</span>
	  			  <span class="token variable">$results</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">geometry</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">location</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">lng</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  			<span class="token variable">$lat</span> <span class="token operator">=</span> <span class="token variable">$results</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">geometry</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">location</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">lat</span><span class="token punctuation">;</span>
	  			<span class="token variable">$lng</span> <span class="token operator">=</span> <span class="token variable">$results</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">geometry</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">location</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">lng</span><span class="token punctuation">;</span>
	  			<span class="token comment" spellcheck="true">// Do stuff</span>
	  		<span class="token punctuation">}</span>
	  	<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/get_coords-form.php" title="Afficher get_coords-form.php" target="_blank" class="code-embed-name">get_coords-form.php</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/get_coords-form.php" title="Back to get_coords-form.php" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>La premier r√©sultat retourn√© est <strong>le plus pertinent selon Google</strong>,
 mais attention&nbsp;: les villes ont des homonymes&nbsp;! Pour plus de 
pertinence, conseillez √† vos utilisateurs de saisir des adresses 
pr√©cises, contenant le code postal, par exemple‚Ä¶</p><h3 id="proposer-des-villes-via-lauto-completion">Proposer des villes via l‚Äôauto-compl√©tion</h3><p>Pour
 √©viter toute erreur de saisie et pour aider l‚Äôinternaute, il est 
relativement simple de mettre en place un syst√®me d‚Äôauto-compl√©tion sur 
le champ de saisie d‚Äôadresse.</p><p>L‚ÄôAPI Google Maps Places met √† disposition un syst√®me d‚Äôauto-compl√©tion facile √† installer.</p><p>Pour cela, dans votre fichier javascript, appelez la librairie, puis une fois qu‚Äôelle est charg√©e appliquez la m√©thode <em>Autocomplete</em> sur votre champ de saisie.</p><div class="code-embed-wrapper"><pre class=" code-embed-pre line-numbers language-javascript" data-start="1" data-line-offset="0" style="counter-reset: linenumber 0;"><code class=" code-embed-code language-javascript"><span class="token keyword">function</span> <span class="token function">doAutoComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">// On cible notre input</span>
	<span class="token keyword">var</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'adresse'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
	  types<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'(cities)'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// Ne proposer que les villes</span>
	  componentRestrictions<span class="token punctuation">:</span> <span class="token punctuation">{</span>country<span class="token punctuation">:</span> <span class="token string">'fr'</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// uniqument les villes fran√ßaises, d'ailleurs</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	autocomplete <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">google<span class="token punctuation">.</span>maps<span class="token punctuation">.</span>places<span class="token punctuation">.</span>Autocomplete</span><span class="token punctuation">(</span> input<span class="token punctuation">,</span> options <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Chargement asynchrone de la librairie Goole Maps places</span>
window<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
	script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'https://maps.googleapis.com/maps/api/js?libraries=places&amp;callback=doAutoComplete'</span><span class="token punctuation">;</span>
	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span><span class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="code-embed-infos"> <a href="https://bitbucket.org/willybahuaud/articles-wabeo/src/master/get-user-coordinates/autocomplete-google-api.js" title="Afficher autocomplete-google-api.js" target="_blank" class="code-embed-name">autocomplete-google-api.js</a> <a href="https://bitbucket.org/api/1.0/repositories/willybahuaud/articles-wabeo/raw/master/get-user-coordinates/autocomplete-google-api.js" title="Back to autocomplete-google-api.js" class="code-embed-raw" target="_blank">affichage brut</a></div></div><p>Il est aussi possible d‚Äôaffiner l‚Äôauto-compl√©tion, comme dans cet exemple, en restrayant les suggestions aux villes d‚Äôun pays.</p><p>Voil√†,
 nous avons fait le tour des quelques m√©thodes qui vous seront utiles 
pour r√©cup√©rer la position de vos utilisateurs, en vue certainement de 
les utiliser dans le cadre de <a title="Faire des r√©qu√™tes g√©olocalis√©es avec WordPress" href="https://wabeo.fr/requete-geolocalisee-wordpress/">requ√™tes WordPress par coordonn√©es g√©ographiques</a>.</p></div> <section class="comments-list texte" id="commentaires"><header id="commentaires">8 commentaires</header><div class="comment-item item-1"><div class="comment-profil-pic profil-pict-1"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/2204350d744feff963a0936cd7e4838f-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info">mo<span class="date">, il y a 3 ann√©es</span></div><div class="mca-author" data-name="mo" data-realname="mo">merci , cela fonction on smartphone ?</div></div><div class="comment-item item-2"><div class="comment-profil-pic profil-pict-2"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/5607bddcc20947cb21c475be46f96958-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info">michael<span class="date">, il y a 3 ann√©es</span></div><div class="mca-author" data-name="michael" data-realname="michael">Bonjour et merci pour le tuto complet qui rentre bien dans un de mes projets mais une question me taraude :<br>
 Dans le cas d‚Äôun smartphone, un site mobile-friendly ‚Ä¶ dans mon cas, 
j‚Äôobtiens une localisation parisienne alors que je suis au bord de la 
grande bleue. Y a-t-il une astuce pour un geolocalisation plus pr√©cise 
ou bien la solution ne peut-√™tre qu‚Äôune appli qui r√©cup√©rerait la 
localisation GPS du t√©l√©phone ?</div></div><div class="comment-item item-3"><div class="comment-profil-pic profil-pict-1"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/b2337262f37278dc7b4d900e4a6ae676-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info">Antoine Brossault<span class="date">, il y a 2 ann√©es</span></div><div class="mca-author" data-name="antoine-brossault" data-realname="Antoine Brossault">Le fait de servir un contenu en fonction de la localisation n‚Äôest il pas dangereux pour le SEO du site ?<br> Google pourrait prendre cela pour du cloaking, non ?<p></p><p>Avez vous mis en place des noms de domaines selon les diff√©rentes versions ?</p><p>Merci de l‚Äôarticle en tous cas <img draggable="false" class="emoji" alt="üôÇ" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1f642.svg"></p><p>Antoine</p></div></div><div class="comment-item item-1"><div class="comment-profil-pic profil-pict-2"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/c4f055f7033e597386470f32261e405b-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info"><a href="http://pastacode.wabeo.fr/" rel="external nofollow" class="url">Willy Bahuaud</a><span class="date">, il y a 2 ann√©es</span></div><div class="mca-author" data-name="willy-bahuaud" data-realname="Willy Bahuaud">Non,
 je ne pense pas que Google consid√®re cela comme du cloaking, c‚Äôest 
juste du contenu personnalis√© en fonction de la localisation. Pour 
Google, rien ne changera (chaque moteur aura toujours une page de 
r√©sultat locale).</div></div><div class="comment-item item-2"><div class="comment-profil-pic profil-pict-1"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/c4f055f7033e597386470f32261e405b-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info"><a href="http://pastacode.wabeo.fr/" rel="external nofollow" class="url">Willy Bahuaud</a><span class="date">, il y a 2 ann√©es</span></div><div class="mca-author" data-name="willy-bahuaud" data-realname="Willy Bahuaud"><button type="button" data-target="mo" class="mca-button">@mo</button> , <button type="button" data-target="michael" class="mca-button">@michael</button>
 comme pr√©cis√© dans l‚Äôarticle, la premi√®re m√©thode, qui se base sur un 
base d‚ÄôIP ne peut pas fonctionn√© avec un smartphone car les IP sont 
attribu√©es au niveau central de l‚Äôop√©rateur t√©l√©phonique. Il vaut donc 
se baser sur le navigateur du client (qui lui utilisera le GPS du 
t√©l√©phone).</div></div><div class="comment-item item-3"><div class="comment-profil-pic profil-pict-2"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/61244568d272ac8f49bfafeac4aa058f-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info">Vincent<span class="date">, il y a 1 ann√©e</span></div><div class="mca-author" data-name="vincent" data-realname="Vincent">Salut,<br>
 si on oublie les mobiles, est-ce que selon toi, une application comme 
par exemple WifiMapper (elle scanne les r√©seaux Wifi qui sont √† la 
port√©s du smartphone) peut tr√®s bien connaitre les coordonn√©es GPS 
exactes d‚Äôun internaute utilisant un desktop si ils couplent √ßa avec un 
service comme Googlemap ?</div></div><div class="comment-item item-1"><div class="comment-profil-pic profil-pict-1"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/c4f055f7033e597386470f32261e405b-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info"><a href="http://pastacode.wabeo.fr/" rel="external nofollow" class="url">Willy Bahuaud</a><span class="date">, il y a 1 ann√©e</span></div><div class="mca-author" data-name="willy-bahuaud" data-realname="Willy Bahuaud"><button type="button" data-target="vincent" class="mca-button">@Vincent</button>
 J‚Äôavoue que je n‚Äôai pas compris la question‚Ä¶ comment une appli 
cellulaire pourrait d√©tecter la position d‚Äôun utilisateur desktop ?<p></p><p>Les
 ordinateurs fixes peuvent sans soucis √™tre g√©olocalis√©s avec les 
m√©thode d√©crites dans ce tutoriel. S‚Äôil s‚Äôagit de recouper ces infos de 
positionnement avec celle des utilisateurs mobiles (issue d‚Äôune autre 
syst√®me de g√©olocalisation), je ne vois pas le soucis. Ais-je r√©pondu √† 
ta question&nbsp;?</p></div></div><div class="comment-item item-2"><div class="comment-profil-pic profil-pict-2"><img alt="" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1b3721afd0d0dbceebdb8bce26df9470-s120.jpg" class="avatar avatar-120" width="120" height="120"></div><div class="comment-info">Lionel<span class="date">, il y a 9 mois</span></div><div class="mca-author" data-name="lionel" data-realname="Lionel">Vraiment
 int√©ressant et complet cet article sur la g√©olocalisation et le tra√ßage
 des visiteurs, m√™me si cela est un l√©g√®rement trop technique pour moi, 
cela peut apporter des informations cruciales sur le visiteur et ainsi 
lui apporter une solution ultra cibl√©e.</div></div></section><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Laisser un commentaire <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://wabeo.fr/coordonnees-gps-utilisateur/#respond" style="display:none;">Annuler la r√©ponse.</a></small></h3><form action="https://wabeo.fr/wp-comments-post.php" method="post" id="commentform" class="frm_style_formidable-style with_frm_style" novalidate=""><p class="comment-notes"><span id="email-notes">Votre adresse de messagerie ne sera pas publi√©e.</span> Les champs obligatoires sont indiqu√©s avec <span class="required">*</span></p><p class="frm_form_field comment-form-comment"><textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea><label for="comment">Commentaire</label></p><p class="frm_form_field frm_third frm_first comment-form-author"><input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"> <label for="author">Nom <span class="required">*</span></label></p><p class="frm_form_field frm_third comment-form-email"><input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="email"> <label for="email">Adresse de messagerie <span class="required">*</span></label></p><p class="frm_form_field frm_third comment-form-url"><input id="url" name="url" size="30" maxlength="200" type="url"> <label for="url">Site web</label></p><p class="form-submit frm_submit"><input name="submit" id="submit" class="frm_button_submit" value="Laisser un commentaire" type="submit"> <input name="comment_post_ID" value="2653" id="comment_post_ID" type="hidden"> <input name="comment_parent" id="comment_parent" value="0" type="hidden"></p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="a6f48461cd" type="hidden"></p><p style="display: none;"></p><input id="ak_js" name="ak_js" value="1511713182705" type="hidden"></form></div> </main><div class="article-author texte will-out"><p>Publi√© le 08 avril 2015<br>par Willy Bahuaud<br>Cat√©gorie <a href="https://wabeo.fr/categorie/developpement/" rel="category tag">D√©veloppement WordPress</a><br><button id="go-comments">8 commentaires</button></p></div><div id="toc-wrapper" class="toc will-out"><nav id="toc"><span id="toc-title" class="toc-title">Sommaire</span><ol><li class="level2"><a href="#geolocaliser-un-visiteur-par-son-ip" class="title_lvl2" style=""><span class="title_lvl">1. </span>Geolocaliser un visiteur par son IP</a></li><li class="level3"><a href="#mise-en-place-de-la-table" class="title_lvl3" style=""><span class="title_lvl">1.1. </span>Mise en place de la table</a></li><li class="level3"><a href="#recuperer-les-coordonnees-gps-a-partir-de-lip" class="title_lvl3" style=""><span class="title_lvl">1.2. </span>R√©cup√©rer les coordonn√©es GPS √† partir de l'IP</a></li><li class="level2"><a href="#en-javascript-via-le-navigateur" class="title_lvl2 current" style=""><span class="title_lvl">2. </span>En javascript via le navigateur</a></li><li class="level2"><a href="#formulaire-et-api-de-geocoding" class="title_lvl2" style=""><span class="title_lvl">3. </span>Formulaire et API de geocoding</a></li><li class="level3"><a href="#proposer-des-villes-via-lauto-completion" class="title_lvl3" style=""><span class="title_lvl">3.1. </span>Proposer des villes via l'auto-compl√©tion</a></li></ol></nav></div></div><div class="temp" id="temp"></div><footer class="footer"><div class="footer-wrapper"><div class="bloc"><p>Me parler</p><div class="coordonnes"><div class="reseaux"> <a href="https://twitter.com/willybahuaud" class="reseau twitter" target="_blank">Twitter</a> <a href="https://www.facebook.com/wabeo-134476379909695/?fref=ts" class="reseau facebook" target="_blank">Facebook</a> <a href="https://plus.google.com/u/0/+WabeoFr/" class="reseau google" target="_blank">Google</a> <a href="https://www.linkedin.com/in/willybahuaud/" class="reseau linkedin" target="_blank">LinkedIn</a></div> <a href="tel:0972834284">09 72 83 42 84</a> <a href="mailto:bonjour@wabeo.fr">bonjour@wabeo.fr</a></div></div><div class="bloc"><p>√Ä propos</p><div class="coordonnes"><form action="https://wabeo.fr/" class="search"><p class="login-form-p"> <label for="s">Rechercher‚Ä¶</label> <input name="s" id="s" type="text"> <button type="submit"><img draggable="false" class="emoji" alt="üîç" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/1f50d.svg"></button></p></form> <a href="https://wabeo.fr/mentions-legales/">Mentions l√©gales</a><a href="https://wabeo.fr/plan-de-site/">Plan de site</a><a href="https://wabeo.fr/creation-site/">Comment est fait ce site ?</a></div></div><form class="login-form" name="loginform" id="loginform" action="https://wabeo.fr/login/" method="post"><p>Espace client</p><div class="field-wrap"><p class="login-username login-form-p"> <label for="user_login">Identifiant</label> <input name="log" id="user_login" class="input" size="20" type="text"></p><p class="login-password login-form-p"> <label for="user_pass">Mot de passe</label> <input name="pwd" id="user_pass" class="input" value="" size="20" type="password"></p></div><p class="login-submit"> <input name="wp-submit" id="wp-submit" class="button button-primary" value="Ok" type="submit"> <input name="redirect_to" value="https://wabeo.fr/mon-espace-client/" type="hidden"></p></form></div> <button id="go-top" class="go-top" aria-hidden="">‚Üë</button> </footer><div class="hidden"> <svg> <defs> <clipPath id="flex1" clipPathUnits="objectBoundingBox"> <path d="M0 0L 1 0.1 .98 1 .02 .96 0 0Z"></path> </clipPath> <clipPath id="flex2" clipPathUnits="objectBoundingBox"> <path d="M.05 0L .95 .16 .98 .95 .02 1 .05 0Z"></path> </clipPath> <clipPath id="flex3" clipPathUnits="objectBoundingBox"> <path d="M.05 .1L .95 0 .98 1 .02 .95 .05 .1Z"></path> </clipPath> <clipPath id="flex4" clipPathUnits="objectBoundingBox"> <path d="M.025 .04L .96 0 1 .98 0 1 .025 .04Z"></path> </clipPath> <clipPath id="flex5" clipPathUnits="objectBoundingBox"> <path d="M.05 0L 1 .065 .94 1 .02 .95 .05 0Z"></path> </clipPath> <clipPath id="flex6" clipPathUnits="objectBoundingBox"> <path d="M.02 0L 1 .025 1 .98 0 1 .02 0Z"></path> </clipPath> <clipPath id="commentPath1" clipPathUnits="objectBoundingBox"> <path d="M.8 0L 1 .2 .95 .95 .6 1 .2 .8 0 .4 .2 .1 Z"></path> </clipPath> <clipPath id="commentPath2" clipPathUnits="objectBoundingBox"> <path d="M.6 0L .97 .1 1 1 .5 .94 .2 .8 0 .45 .2 .2 Z"></path> </clipPath> </defs> </svg><div id="hidden_forms" class="hidden_forms"><div class="frm_forms  with_frm_style frm_style_formidable-style" id="frm_form_5_container"><form enctype="multipart/form-data" method="post" class="frm-show-form  frm_pro_form  frm_ajax_submit " id="form_je84w"><div class="frm_form_fields "><fieldset><legend class="frm_hidden">Questionnaire contact</legend><input name="frm_action" value="create" type="hidden"> <input name="form_id" value="5" type="hidden"> <input name="frm_hide_fields_5" id="frm_hide_fields_5" value="[&quot;frm_field_65_container&quot;,&quot;frm_field_71_container&quot;,&quot;frm_field_73_container&quot;,&quot;frm_field_74_container&quot;,&quot;frm_field_66_container&quot;,&quot;frm_field_78_container&quot;,&quot;frm_field_77_container&quot;,&quot;frm_field_75_container&quot;,&quot;frm_field_67_container&quot;,&quot;frm_field_79_container&quot;,&quot;frm_field_81_container&quot;,&quot;frm_field_80_container&quot;,&quot;frm_field_72_container&quot;]" type="hidden"> <input name="form_key" value="je84w" type="hidden"> <input name="item_meta[0]" value="" type="hidden"> <input id="frm_submit_entry_5" name="frm_submit_entry_5" value="87b84f7fdf" type="hidden"><input name="_wp_http_referer" value="/coordonnees-gps-utilisateur/" type="hidden"><input class="frm_hidden frm_verify" id="frm_verify_5" name="frm_verify" style="display:none;" type="text"><div id="frm_field_69_container" class="frm_form_field form-field  frm_required_field frm_top_container frm_first frm_third"> <input id="field_6s4kg" name="item_meta[69]" data-reqmsg="Ce champ ne peut pas √™tre vide" type="text"><label for="field_6s4kg" class="frm_primary_label">Votre pr√©nom <span class="frm_required">*</span> </label></div><div id="frm_field_68_container" class="frm_form_field form-field  frm_required_field frm_top_container frm_third"> <input id="field_qy6jh" name="item_meta[68]" data-reqmsg="Ce champ ne peut pas √™tre vide" type="text"><label for="field_qy6jh" class="frm_primary_label">Votre nom <span class="frm_required">*</span> </label></div><div id="frm_field_70_container" class="frm_form_field form-field  frm_required_field frm_top_container frm_third"> <input id="field_fofko" name="item_meta[70]" data-reqmsg="Ce champ ne peut pas √™tre vide" data-invmsg="Votre adresse email est non valide" type="email"><label for="field_fofko" class="frm_primary_label">Votre adresse email <span class="frm_required">*</span> </label></div><div id="frm_field_64_container" class="frm_form_field form-field  frm_required_field frm_top_container"> <select name="item_meta[64]" id="field_x8qxx" data-reqmsg="Ce champ ne peut pas √™tre vide"><option value="" selected="selected"></option><option value="Je souhaite un devis">Je souhaite un devis</option><option value="Je souhaite demander de l‚Äôaide par rapport √† l‚Äôun des articles">Je souhaite demander de l‚Äôaide par rapport √† l‚Äôun des articles</option><option value="Je souhaite vous envoyer un message √† propos d‚Äôun autre sujet">Je souhaite vous envoyer un message √† propos d‚Äôun autre sujet</option> </select> <label for="field_x8qxx" class="frm_primary_label">Que puis-je faire pour vous ? <span class="frm_required">*</span> </label></div><div id="frm_field_65_container" class="frm_form_field form-field  frm_required_field frm_top_container" style="display: none;"> <select name="item_meta[65]" id="field_9n1vr" data-reqmsg="Ce champ ne peut pas √™tre vide"><option value="" selected="selected"></option><option value="La cr√©ation d‚Äôun site">La cr√©ation d‚Äôun site</option><option value="La refonte d‚Äôun site existant">La refonte d‚Äôun site existant</option><option value="La cr√©ation d‚Äôun plugin">La cr√©ation d‚Äôun plugin</option><option value="La maintenance d‚Äôun site">La maintenance d‚Äôun site</option><option value="Un d√©veloppement sp√©cifique">Un d√©veloppement sp√©cifique</option><option value="La cr√©ation d‚Äôun logo">La cr√©ation d‚Äôun logo</option> </select> <label for="field_9n1vr" class="frm_primary_label">Un devis pour quel type de mission ? <span class="frm_required">*</span> </label></div><div id="frm_field_71_container" class="frm_form_field form-field  frm_top_container frm_first frm_half" style="display: none;"> <input id="field_98kgs" name="item_meta[71]" data-invmsg="Quelle est l‚ÄôURL du site actuel ? est non valide" type="url"><label for="field_98kgs" class="frm_primary_label">Quelle est l‚ÄôURL du site actuel ? <span class="frm_required"></span> </label></div><div id="frm_field_73_container" class="frm_form_field form-field  frm_top_container frm_half" style="display: none;"> <input id="field_5i3tn" name="item_meta[73]" type="text"><label for="field_5i3tn" class="frm_primary_label">Le site actuel est-il sur WordPress, Joomla, Drupal, ‚Ä¶ <span class="frm_required"></span> </label></div><div id="frm_field_74_container" class="frm_form_field form-field  frm_top_container" style="display: none;"> <input id="field_krrwr" name="item_meta[74]" data-invmsg="L‚ÄôURL n‚Äôest pas valide" type="url"><label for="field_krrwr" class="frm_primary_label">Quelle est l‚ÄôURL de ce site ? <span class="frm_required"></span> </label></div><div id="frm_field_66_container" class="frm_form_field form-field  frm_required_field frm_top_container" style="display: none;"> <input id="field_btcee" name="item_meta[66]" data-reqmsg="Ce champ ne peut pas √™tre vide" type="text"><label for="field_btcee" class="frm_primary_label">A quel propos ? <span class="frm_required">*</span> </label></div><div id="frm_field_78_container" class="frm_form_field form-field  frm_top_container frm_first frm_third checkbox-list" style="display: none;"> <label class="frm_primary_label">Sur quelles parties souhaitez-vous que j‚Äôintervienne ? <span class="frm_required"></span> </label><div class="frm_opt_container"><div class="frm_checkbox" id="frm_checkbox_78-0"><label for="field_5428a-0"><input name="item_meta[78][]" id="field_5428a-0" value="Le design du site" type="checkbox"> Le design du site</label></div><div class="frm_checkbox" id="frm_checkbox_78-1"><label for="field_5428a-1"><input name="item_meta[78][]" id="field_5428a-1" value="L‚Äôint√©gration" type="checkbox"> L‚Äôint√©gration</label></div><div class="frm_checkbox" id="frm_checkbox_78-2"><label for="field_5428a-2"><input name="item_meta[78][]" id="field_5428a-2" value="Le d√©veloppement" type="checkbox"> Le d√©veloppement</label></div><div class="frm_checkbox" id="frm_checkbox_78-3"><label for="field_5428a-3"><input name="item_meta[78][]" id="field_5428a-3" value="Le r√©f√©rencement" type="checkbox"> Le r√©f√©rencement</label></div><div class="frm_checkbox" id="frm_checkbox_78-4"><label for="field_5428a-4"><input name="item_meta[78][]" id="field_5428a-4" value="La maintenance" type="checkbox"> La maintenance</label></div><div class="frm_checkbox" id="frm_checkbox_78-5"><label for="field_5428a-5"><input name="item_meta[78][]" id="field_5428a-5" value="L‚Äôh√©bergement" type="checkbox"> L‚Äôh√©bergement</label></div><div class="frm_checkbox" id="frm_checkbox_78-6"><label for="field_5428a-6"><input name="item_meta[78][]" id="field_5428a-6" value="La gestion du projet" type="checkbox"> La gestion du projet</label></div></div></div><div id="frm_field_77_container" class="frm_form_field form-field  frm_top_container frm_third checkbox-list" style="display: none;"> <label class="frm_primary_label">Y-a-t‚Äôil des fonctionnalit√©s particuli√®res √† mettre en place ? <span class="frm_required"></span> </label><div class="frm_opt_container"><div class="frm_checkbox" id="frm_checkbox_77-0"><label for="field_53wam-0"><input name="item_meta[77][]" id="field_53wam-0" value="La gestion du site en plusieurs langues" type="checkbox"> La gestion du site en plusieurs langues</label></div><div class="frm_checkbox" id="frm_checkbox_77-1"><label for="field_53wam-1"><input name="item_meta[77][]" id="field_53wam-1" value="Un espace membre" type="checkbox"> Un espace membre</label></div><div class="frm_checkbox" id="frm_checkbox_77-2"><label for="field_53wam-2"><input name="item_meta[77][]" id="field_53wam-2" value="Un annuaire" type="checkbox"> Un annuaire</label></div><div class="frm_checkbox" id="frm_checkbox_77-3"><label for="field_53wam-3"><input name="item_meta[77][]" id="field_53wam-3" value="Une boutique e-commerce" type="checkbox"> Une boutique e-commerce</label></div><div class="frm_checkbox" id="frm_checkbox_77-4"><label for="field_53wam-4"><input name="item_meta[77][]" id="field_53wam-4" value="Un syst√®me de r√©servation" type="checkbox"> Un syst√®me de r√©servation</label></div><div class="frm_checkbox" id="frm_checkbox_77-5"><label for="field_53wam-5"><input name="item_meta[77][]" id="field_53wam-5" value="Un moteur de recherche multicrit√®re" type="checkbox"> Un moteur de recherche multicrit√®re</label></div><div class="frm_checkbox" id="frm_checkbox_77-6"><label for="field_53wam-6"><input name="item_meta[77][]" id="field_53wam-6" value="Un forum" type="checkbox"> Un forum</label></div></div></div><div id="frm_field_75_container" class="frm_form_field form-field  frm_top_container frm_third" style="display: none;"> <select name="item_meta[75]" id="field_leh8n"><option value="" selected="selected"></option><option value="Entre 1000 ‚Ç¨ et 3000 ‚Ç¨">Entre 1000 ‚Ç¨ et 3000 ‚Ç¨</option><option value="Entre 3000 ‚Ç¨ et 6000 ‚Ç¨">Entre 3000 ‚Ç¨ et 6000 ‚Ç¨</option><option value="Entre 6000‚Ç¨ et 10000 ‚Ç¨">Entre 6000‚Ç¨ et 10000 ‚Ç¨</option><option value="Plus de 10 000 ‚Ç¨">Plus de 10 000 ‚Ç¨</option> </select> <label for="field_leh8n" class="frm_primary_label">Avez-vous une fourchette budg√©taire ? <span class="frm_required"></span> </label><div class="frm_description">Cette
 information est facultative mais me permet d‚Äôestimer le temps que je 
peux passer sur le projet, et d‚Äôorienter mon devis vers du ¬´ sur-mesure ¬ª
 ou vers une solution plus √©conomique.</div></div><div id="frm_field_67_container" class="frm_form_field form-field  frm_required_field frm_top_container" style="display: none;"><textarea name="item_meta[67]" id="field_esrtf" rows="5" data-reqmsg="Ce champ ne peut pas √™tre vide"></textarea><label for="field_esrtf" class="frm_primary_label">Votre message <span class="frm_required">*</span> </label></div><div id="frm_field_79_container" class="frm_form_field form-field  frm_required_field frm_top_container" style="display: none;"><textarea name="item_meta[79]" id="field_7lcfq" rows="7" data-reqmsg="Ce champ ne peut pas √™tre vide"></textarea><label for="field_7lcfq" class="frm_primary_label">Dites m‚Äôen plus‚Ä¶ <span class="frm_required">*</span> </label></div><div id="frm_field_81_container" class="frm_form_field form-field  frm_top_container frm_three_fourths frm_first" style="display: none;"><textarea name="item_meta[81]" id="field_f3r87" rows="10"></textarea><label for="field_f3r87" class="frm_primary_label">Pouvez-vous m‚Äôexpliquer plus en d√©tail le projet ? <span class="frm_required"></span> </label></div><div id="frm_field_80_container" class="frm_form_field form-field  frm_top_container frm_fourth upload-field" style="display: none;"> <label for="field_upwvz" class="frm_primary_label">Si vous avez un cahier des charges, vous pouvez me le transmettre <span class="frm_required"></span> </label> <input name="item_meta[80]" value="" data-frmfile="80" type="hidden"><div class="frm_dropzone frm_single_upload dz-clickable" id="file80_dropzone"><div class="dz-message needsclick"> <span class="frm_icon_font frm_upload_icon"></span> <span class="frm_upload_text">D√©poser un fichier ici ou cliquer pour t√©l√©charger</span> <span class="frm_compact_text">Choisir un fichier</span><div class="frm_small_text"> Taille de t√©l√©chargement maximum : 10Mo</div></div></div></div><div id="frm_field_72_container" class="frm_form_field form-field  frm_top_container" style="display: none;"> <input id="field_nh894" name="item_meta[72]" type="text"><label for="field_nh894" class="frm_primary_label">Laissez-moi votre num√©ro de t√©l√©phone <span class="frm_required"></span> </label></div> <input name="item_key" value="" type="hidden"><div class="frm_submit"><button class="frm_button_submit frm_final_submit" type="submit" formnovalidate="formnovalidate">Envoyer le message</button></div></fieldset></div><input class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;" type="file"></form></div></div></div> <script type="text/javascript" data-cfasync="false" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-mention-comments-authors-js-jquery-mention.js"></script> <script type="text/javascript">/*  */
var mcaCommentTextarea = "textarea[name=\"comment\"]";
/*  */</script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-mention-comments-authors-js-mca-comment-sc.js"></script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-pastacode-js-prism-2.js"></script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-pastacode-plugins-normalize-whitespace-pri.js"></script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-pastacode-plugins-line-highlight-prism-lin.js"></script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-pastacode-plugins-line-numbers-prism-line-.js"></script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-themes-nebula2017-js-paper-full.js"></script> <script type="text/javascript">/*  */
var initialSide = "left";
/*  */</script> <script type="text/paperscript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-themes-nebula2017-js-background-10.js" canvas="myCanvas" data-paper-ignore="true"></script> <script type="text/javascript">/*  */
var logoWabeo = "https:\/\/wabeo.fr\/wp-content\/themes\/nebula2017\/img\/logo-wabeo-black.svg";
/*  */</script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-themes-nebula2017-js-logo-10.js"></script> <script type="text/javascript">/*  */
var willyHome = "https:\/\/wabeo.fr";
/*  */</script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-themes-nebula2017-js-script-10.js"></script> <script async="async" type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-akismet-_inc-form-4.js"></script> <script type="text/javascript">/*
  */
var frm_js = 
{"ajax_url":"https:\/\/wabeo.fr\/wp-admin\/admin-ajax.php","images_url":"https:\/\/wabeo.fr\/wp-content\/plugins\/formidable\/images","loading":"Loading\u2026","remove":"Supprimer","offset":"4","nonce":"8ecaed5d8d","id":"ID","no_results":"No
 results match","file_spam":"That file looks like 
Spam.","empty_fields":"Please complete the preceding required fields 
before uploading a file."};
/*  */</script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-formidable-js-formidable.js"></script> <script type="text/javascript" src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/wp-content-plugins-formidable-pro-js-dropzone-4.js"></script> <script src="R%C3%A9cup%C3%A9rer%20les%20coordonn%C3%A9es%20GPS%20de%20vos%20visiteurs%20%E2%80%93%20Wabeo_fichiers/api.js"></script> <script type="text/javascript">/**/
var
 
frmrules={"64":{"fieldId":"64","fieldKey":"x8qxx","fieldType":"select","inputType":"select","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":["65","66","67","67","72"],"showHide":"show","anyAll":"any","conditions":[]},"65":{"fieldId":"65","fieldKey":"9n1vr","fieldType":"select","inputType":"select","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":["71","73","74","78","78","77","77","75","75","79","79","79","79","81","81","80","80"],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"64","operator":"==","value":"Je
 souhaite un 
devis"}],"status":"complete"},"71":{"fieldId":"71","fieldKey":"98kgs","fieldType":"url","inputType":"url","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 refonte d\u2019un site 
existant"}],"status":"complete"},"73":{"fieldId":"73","fieldKey":"5i3tn","fieldType":"text","inputType":"text","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 refonte d\u2019un site 
existant"}],"status":"complete"},"74":{"fieldId":"74","fieldKey":"krrwr","fieldType":"url","inputType":"url","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 maintenance d\u2019un 
site"}],"status":"complete"},"66":{"fieldId":"66","fieldKey":"btcee","fieldType":"text","inputType":"text","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"64","operator":"==","value":"Je
 souhaite vous envoyer un message \u00e0 propos d\u2019un autre 
sujet"}],"status":"complete"},"78":{"fieldId":"78","fieldKey":"5428a","fieldType":"checkbox","inputType":"checkbox","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 cr\u00e9ation d\u2019un 
site"},{"fieldId":"65","operator":"==","value":"La refonte d\u2019un 
site 
existant"}],"status":"complete"},"77":{"fieldId":"77","fieldKey":"53wam","fieldType":"checkbox","inputType":"checkbox","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 cr\u00e9ation d\u2019un 
site"},{"fieldId":"65","operator":"==","value":"La refonte d\u2019un 
site 
existant"}],"status":"complete"},"75":{"fieldId":"75","fieldKey":"leh8n","fieldType":"select","inputType":"select","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 cr\u00e9ation d\u2019un 
site"},{"fieldId":"65","operator":"==","value":"La refonte d\u2019un 
site 
existant"}],"status":"complete"},"67":{"fieldId":"67","fieldKey":"esrtf","fieldType":"textarea","inputType":"textarea","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"64","operator":"==","value":"Je
 souhaite demander de l\u2019aide par rapport \u00e0 l\u2019un des 
articles"},{"fieldId":"64","operator":"==","value":"Je souhaite vous 
envoyer un message \u00e0 propos d\u2019un autre 
sujet"}],"status":"complete"},"79":{"fieldId":"79","fieldKey":"7lcfq","fieldType":"textarea","inputType":"textarea","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 cr\u00e9ation d\u2019un 
plugin"},{"fieldId":"65","operator":"==","value":"La maintenance 
d\u2019un site"},{"fieldId":"65","operator":"==","value":"Un 
d\u00e9veloppement 
sp\u00e9cifique"},{"fieldId":"65","operator":"==","value":"La 
cr\u00e9ation d\u2019un 
logo"}],"status":"complete"},"81":{"fieldId":"81","fieldKey":"f3r87","fieldType":"textarea","inputType":"textarea","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 cr\u00e9ation d\u2019un 
site"},{"fieldId":"65","operator":"==","value":"La refonte d\u2019un 
site 
existant"}],"status":"complete"},"80":{"fieldId":"80","fieldKey":"upwvz","fieldType":"file","inputType":"file","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"65","operator":"==","value":"La
 cr\u00e9ation d\u2019un 
site"},{"fieldId":"65","operator":"==","value":"La refonte d\u2019un 
site 
existant"}],"status":"complete"},"72":{"fieldId":"72","fieldKey":"nh894","fieldType":"text","inputType":"text","isMultiSelect":false,"formId":"5","inSection":"0","inEmbedForm":"0","isRepeating":false,"dependents":[],"showHide":"show","anyAll":"any","conditions":[{"fieldId":"64","operator":"==","value":"Je
 souhaite un devis"}],"status":"complete"}};
if(typeof __FRMRULES == 'undefined'){__FRMRULES=frmrules;}
else{__FRMRULES=jQuery.extend({},__FRMRULES,frmrules);}var 
frmHide=["65","71","73","74","66","78","77","75","67","79","81","80","72"];if(typeof
 __frmHideOrShowFields == 
"undefined"){__frmHideOrShowFields=frmHide;}else{__frmHideOrShowFields=jQuery.extend(__frmHideOrShowFields,frmHide);}__frmDropzone=[{"maxFilesize":10,"maxFiles":1,"htmlID":"file80","uploadMultiple":false,"fieldID":"80","formID":"5","parentFormID":"5","fieldName":"item_meta[80]","mockFiles":[],"defaultMessage":"Drop
 files here to upload","fallbackMessage":"Your browser does not support 
drag and drop file uploads.","fallbackText":"Please use the fallback 
form below to upload your files like in the olden 
days.","fileTooBig":"Ce fichier est trop volumineux. Sa taille doit 
\u00eatre inf\u00e9rieure \u00e0 
{{maxFilesize}}Mo.","invalidFileType":"T\u00e9l\u00e9chargement de 
fichier est non valide","responseError":"Server responded with 
{{statusCode}} code.","cancel":"Annuler 
l'envoi","cancelConfirm":"\u00cates-vous s\u00fbr de vouloir annuler cet
 envoi ?","remove":"Supprimer le fichier","maxFilesExceeded":"Vous avez 
t\u00e9l\u00e9charger trop de fichiers. Vous ne pouvez envoyer que 1 
fichier(s)."}];/**/</script> 
<div id="textarea_simulator" style="position: absolute; top: 0px; left: 0px; visibility: hidden;"></div></body></html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me - Debug: cached@1511678905 -->